<!doctype html><html lang=en-US><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=author content="Rohan Jain"><meta name=description content="Having been blessed with an unreliable internet, I always have had the need to
change the default route when one goes down. ip provides you the required
tooling to do that. I had been doing it so often, that I ended up writing a
function to do this:
route_to () {
    interface=$1
    route=$(ip route | grep $interface | sed -r 's/\.0\/[[:digit:]]{2,3} /.1 /' | cut -d ' ' -f -4)
    if [ -n &#34;$route&#34; ]; then
        sudo ip route del default &> /dev/null
        sudo ip route replace default via $route
    else
        echo &#34;No routes match: $interface&#34; >&amp;2
    fi
}
With this in available in my shell, I can simply do route_to wlan0 and my
system will start using wlan0 as the default interface."><meta property="og:url" content="/route-to/"><meta property="og:site_name" content="The Perpetual Amature"><meta property="og:title" content="Switch between networks based on availability"><meta property="og:description" content="Having been blessed with an unreliable internet, I always have had the need to change the default route when one goes down. ip provides you the required tooling to do that. I had been doing it so often, that I ended up writing a function to do this:
route_to () { interface=$1 route=$(ip route | grep $interface | sed -r 's/\.0\/[[:digit:]]{2,3} /.1 /' | cut -d ' ' -f -4) if [ -n &#34;$route&#34; ]; then sudo ip route del default &> /dev/null sudo ip route replace default via $route else echo &#34;No routes match: $interface&#34; >&amp;2 fi } With this in available in my shell, I can simply do route_to wlan0 and my system will start using wlan0 as the default interface."><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2015-08-19T00:00:00+00:00"><meta property="article:modified_time" content="2015-08-19T00:00:00+00:00"><title>Switch between networks based on availability</title><link rel=canonical href=/route-to/><link rel=stylesheet href=/css/pygments.min.42fe0099f9515ec8cb510d96b2ec79b3525dab83b63dc7ca290b29679ae42e97.css integrity="sha256-Qv4AmflRXsjLUQ2Wsux5s1Jdq4O2PcfKKQspZ5rkLpc="><link rel=stylesheet href=/css/main.min.4313ac22ba74ce128c1792022bde3c3ec104c1ab2d633d1cbbc5d8219336f9de.css integrity="sha256-QxOsIrp0zhKMF5ICK948PsEEwastYz0cu8XYIZM2+d4="><link rel="shortcut icon" href=/img/favicon.ico></head><body lang=en><section class=header><div class=container><div class=content><a href=/><img class=avatar src=/img/avatar-small.jpg alt=avatar></a>
<a href=/><div class=name>Rohan Jain</div></a><nav><ul><li class=nav-home><a href=/><span>Home</span></a></li><li class=nav-about><a href=/about/><span>About</span></a></li></ul></nav></div></div></section><section class="main post non-narrow zero-top-spacing"><div class=container><div class=content><div class=front-matter><div class=title-container><div class=page-heading>Switch between networks based on availability</div><div class=initials><a href=/></a></div></div><div class=meta><div class=date title='Wed Aug 19 2015 00:00:00 UTC'>Aug 19, 2015</div><div class=reading-time><div class=middot></div>One minute read</div></div></div><div class=markdown><p>Having been blessed with an unreliable internet, I always have had the need to
change the default route when one goes down. <a href=http://linux.die.net/man/8/ip>ip</a> provides you the required
tooling to do that. I had been doing it so often, that I ended up writing a
function to do this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>route_to <span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>interface</span><span class=o>=</span><span class=nv>$1</span>
</span></span><span class=line><span class=cl>    <span class=nv>route</span><span class=o>=</span><span class=k>$(</span>ip route <span class=p>|</span> grep <span class=nv>$interface</span> <span class=p>|</span> sed -r <span class=s1>&#39;s/\.0\/[[:digit:]]{2,3} /.1 /&#39;</span> <span class=p>|</span> cut -d <span class=s1>&#39; &#39;</span> -f -4<span class=k>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> -n <span class=s2>&#34;</span><span class=nv>$route</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        sudo ip route del default <span class=p>&amp;</span>&gt; /dev/null
</span></span><span class=line><span class=cl>        sudo ip route replace default via <span class=nv>$route</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;No routes match: </span><span class=nv>$interface</span><span class=s2>&#34;</span> &gt;<span class=p>&amp;</span><span class=m>2</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>With this in available in my shell, I can simply do <code>route_to wlan0</code> and my
system will start using <code>wlan0</code> as the default interface.</p><br><p class=back-to-posts><a href=/blog>All Posts</a></p></div></div></div></section><section class=icons><div class=container><div class=content><a href=//github.com/crodjer target=_blank rel=noopener>Github</a>
<a href=//linkedin.com/in/crodjer target=_blank rel=noopener>Linkedin</a>
<a href=//twitter.com/__crodjer__ target=_blank rel=noopener>Twitter</a></div></div></section></body></html>