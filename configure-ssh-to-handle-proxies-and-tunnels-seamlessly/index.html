<!doctype html><html lang=en-US><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=author content="Rohan Jain"><meta name=description content="Configure ssh to handle proxies and tunnels seamlessly | Rohan's Personal Web Blog."><meta property="og:title" content="Configure ssh to handle proxies and tunnels seamlessly"><meta property="og:type" content="article"><meta property="article:published_time" content="2011-08-27T00:00:00+00:00"><meta property="article:modified_time" content="2011-08-27T00:00:00+00:00"><title>Configure ssh to handle proxies and tunnels seamlessly</title><link rel=canonical href=/configure-ssh-to-handle-proxies-and-tunnels-seamlessly/><link rel=stylesheet href=/css/main.min.97ffe0e39b9819392033e2635f05ec47c705d94936b7483bb66889dbf15d7a90.css><link rel="shortcut icon" href=/img/favicon.ico></head><body lang=en><header><a href=/>The Perpetual Amature</a><nav><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li></ul></nav></header><main><h1>Configure ssh to handle proxies and tunnels seamlessly</h1><p>Recently I opened up on the port <em>443</em> over my EC2 instance (more or less like
a VPS), so that I can access it through any firewalled proxy too. Apart from
getting SSH running to a machine from outside world, I did some cool
configuration to have ssh deal with with various remote hosts automatically. It
uses <em>the right</em> proxy settings according the host being accessed.</p><p>All the stuff which runs over ssh (like <em>scp</em>, <em>git</em> etc.) also work the way
they are supposed to, following the ssh configuration.</p><p>To get this to work you need to have <em>corkscrew</em> and <em>netcat</em> (the swiss army
knife) already installed.</p><p>Here is how it goes:<br><code>File ~/.ssh/config:</code></p><pre><code class=language-apache># Let me access local remotes directly.
Host 127.0.0.1, 10.*
    ProxyCommand none

# Github lets you ssh over port 443 too, utilize that instead of tunneling
# through remote computer
Host github.com
    Hostname ssh.github.com
    User git
    ProxyCommand corkscrew 10.3.100.211 8080 %h %p
    Port 443
    Hostname ssh.github.com

# Let me ssh onto my ec2 instance, which has full network access, through a
# http proxy.
Host ecc.rohanjain.in
    ProxyCommand corkscrew 10.3.100.211 8080 %h %p
    Port 443
    ServerAliveInterval 600

# All the rest should connect through an ssh connection over the ec2 instance.
Host *
    ProxyCommand ssh -q -a -x -p 443 ecc.rohanjain.in nc %h %p
</code></pre></main><footer><a href=/blog>All Posts</a>
<a href=//github.com/crodjer target=_blank rel=noopener>Github</a>
<a href=//linkedin.com/in/crodjer target=_blank rel=noopener>Linkedin</a>
<a href=//twitter.com/__crodjer__ target=_blank rel=noopener>Twitter</a></footer><script data-goatcounter=https://t.rohanjain.in/count async src=/js/count.min.4e3257a9873dba863f309fe89287c9f6e962d7be1758704f13b2608e58008e5f.js></script><noscript><img src="https://t.rohanjain.in/count?p=%2fconfigure-ssh-to-handle-proxies-and-tunnels-seamlessly%2f&t=Configure%20ssh%20to%20handle%20proxies%20and%20tunnels%20seamlessly"></noscript></body></html>