<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Django using admin horizontal filter in forms - Rohan Jain</title>
        <meta name="author" content="Rohan Jain">
        <meta charset=utf-8>

        <!-- Favicon -->
        <link href="/favicon.ico" rel="shortcut icon"/>

        <!--Stylesheets-->
        <link rel="stylesheet" media="screen" type="text/css" href="/css/style.css"/>
        <link rel="stylesheet" media="screen" type="text/css" href="/css/syntax.css"/>

        <!--Atom Feed-->
        <link rel="alternate" type="application/atom+xml" title="Atom" href="/atom.xml"/>

        <!-- Scripts-->
        <script type="text/javascript" src="/js/head.min.js"></script>
        <script type="text/javascript">
            //Google analytics
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-15806710-5']);
            _gaq.push(['_trackPageview']);

            //Disqus
            var disqus_shortname = 'crodjer';
            
            head.js(
                "http://www.google-analytics.com/ga.js",
                "https://apis.google.com/js/plusone.js"
            );
            
            head.js("http://crodjer.disqus.com/count.js");
            head.js("http://crodjer.disqus.com/embed.js");
        </script>
  </head>
  <body>
      <div id="header">
    <span class="byline">what crodjer has to say...</span>
    <h1><a href="/">Rohan Jain</a></h1>
</div>

<div id="content">
    
<div class="post">
    <h2 class="post-title" id="django-using-admin-horizontal-filter-in-forms"><a href="/coding/2011/06/20/django-using-admin-horizontal-filter-in-forms/">Django using admin horizontal filter in forms</a></h2>
<div class="meta">
    <span class="date">
        <img alt="Posted on" src="/images/calendar.png"/> 20 Jun, 2011
    </span>
    <span class="share">
        <g:plusone size="small" href="http://www.rohanjain.in/coding/2011/06/20/django-using-admin-horizontal-filter-in-forms/"></g:plusone>&nbsp;
    </span>
    <span class="tags" >
        
        <img alt="Tags" src="/images/tag.png"/>
        
        <a href="/tags/django">django</a>
        
        <a href="/tags/widget">widget</a>
        
        <a href="/tags/snipet">snipet</a>
        
        
    </span>

    <a class="comments" href="/coding/2011/06/20/django-using-admin-horizontal-filter-in-forms/#disqus_thread" data-disqus-identifier="django-using-admin-horizontal-filter-in-forms">Comments</a>
</div>


    <div class='post-text'>
        
        <p>The django admin filter horizontal/vertical widgets are a really cool
replacement of the inconvenient and ugly default multiple select elements.</p>

<p><img src="http://i1105.photobucket.com/albums/h356/crodjer/Blog%20Posts/Selection_010.png" alt="Django admin filter used in auth" /></p>

<p><em>But how do I get these in my normal forms?</em><br />
This is how:</p>

<p>First create a django form with <code>ModelMultipleChoiceField</code> and <code>FilterSelectMultiple</code>
as widget. To get this to work you need to add some extra media files. Here
is the snipet:</p>

<p><em>forms.py</em></p>

<div class="highlight"><pre><code class="python"><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">django.contrib.admin.widgets</span> <span class="kn">import</span> <span class="n">FilteredSelectMultiple</span>

<span class="k">class</span> <span class="nc">TagForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">ModelMultipleChoiceField</span><span class="p">(</span><span class="n">queryset</span><span class="o">=</span><span class="n">Tag</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span>
                                          <span class="n">label</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Select tags&#39;</span><span class="p">),</span>
                                          <span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                          <span class="n">widget</span><span class="o">=</span><span class="n">FilteredSelectMultiple</span><span class="p">(</span>
                                                    <span class="n">_</span><span class="p">(</span><span class="s">&#39;tags&#39;</span><span class="p">),</span>
                                                    <span class="bp">False</span><span class="p">,</span>
                                                 <span class="p">))</span>

    <span class="k">class</span> <span class="nc">Media</span><span class="p">:</span>
        <span class="n">css</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;all&#39;</span><span class="p">:[</span><span class="s">&#39;admin/css/widgets.css&#39;</span><span class="p">,</span>
                   <span class="s">&#39;css/uid-manage-form.css&#39;</span><span class="p">],</span>
        <span class="p">}</span>
        <span class="n">js</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;/admin/jsi18n/&#39;</span><span class="p">]</span>
</code></pre>
</div>

<p>Add form media and form in the template.</p>

<div class="highlight"><pre><code class="django"><span class="x">&lt;!--HEAD --&gt;</span>
<span class="cp">{{</span> <span class="nv">form.media</span> <span class="cp">}}</span><span class="x" />
<span class="x">&lt;!--BODY--&gt;</span>
<span class="cp">{{</span> <span class="nv">form</span> <span class="cp">}}</span><span class="x" />
</code></pre>
</div>

<p>This extra css fixes some layout problems</p>

<div class="highlight"><pre><code class="css"><span class="nc">.selector</span><span class="p">{</span>
    <span class="k">float</span><span class="o">:</span><span class="k">none</span><span class="p">;</span>
    <span class="k">display</span><span class="o">:</span><span class="k">block</span><span class="p">;</span>
    <span class="k">height</span><span class="o">:</span><span class="m">330px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.selector</span> <span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;submit&quot;</span><span class="o">]</span><span class="p">{</span>
    <span class="k">display</span><span class="o">:</span><span class="k">block</span><span class="p">;</span>
    <span class="k">clear</span><span class="o">:</span><span class="k">both</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.selector</span> <span class="nt">h2</span><span class="p">{</span>
    <span class="k">font-size</span><span class="o">:</span><span class="m">15px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.selector</span>  <span class="nt">select</span><span class="p">{</span>
    <span class="k">margin</span><span class="o">:</span> <span class="m">2px</span> <span class="m">0</span><span class="p">;</span>
    <span class="k">padding</span><span class="o">:</span> <span class="m">2px</span> <span class="m">3px</span><span class="p">;</span>
    <span class="k">font-weight</span><span class="o">:</span> <span class="k">normal</span><span class="p">;</span>
    <span class="k">width</span><span class="o">:</span> <span class="m">270px</span> <span class="cp">!important</span><span class="p">;</span>
    <span class="k">height</span><span class="o">:</span> <span class="m">17.2em</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">textarea</span><span class="p">{</span>
    <span class="k">display</span><span class="o">:</span><span class="k">block</span><span class="p">;</span>
    <span class="k">width</span><span class="o">:</span><span class="m">450px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Refrences: <a href="http://j.mp/mAzALa">http://j.mp/mAzALa</a>, <a href="http://j.mp/lIG2Fl">http://j.mp/lIG2Fl</a><br />
I decided to create another post for this because, none of these suggests
the use of admin widget directly.</p>

        
    </div>
</div>



<div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_identifier = 'django-using-admin-horizontal-filter-in-forms';
        var disqus_title = 'Django using admin horizontal filter in forms';
        var disqus_url = 'http://www.rohanjain.in/coding/2011/06/20/django-using-admin-horizontal-filter-in-forms/';
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</div>


</div>

<div id="sidebar">
    <ul>
        <li><a href="/">Blog</a></li>
        <li><a href="/about">About Me</a></li>
        <li><a href="/archive">Archive</a></li>
    </ul>
</div>

<div id="footer">
    <p>
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/80x15.png" /></a>
        Using <a href="http://jekyllrb.com/">Jekyll</a>,
        <a href="http://pygments.org/">Pygments</a>
        | <a href="/sitemap.xml">Sitemap</a>, <a href="http://feeds.feedburner.com/crodjerBlog">Feed</a>
    </p>
</div>

 </body>
</html>
