<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Configure ssh to handle proxies and tunnels seamlessly - Rohan Jain</title>
        <meta name="author" content="Rohan Jain">
        <meta charset=utf-8>

        <!-- Favicon -->
        <link href="/favicon.ico" rel="shortcut icon"/>

        <!--Stylesheets-->
        <link rel="stylesheet" media="screen" type="text/css" href="/css/style.css"/>
        <link rel="stylesheet" media="screen" type="text/css" href="/css/syntax.css"/>

        <!--Atom Feed-->
        <link rel="alternate" type="application/atom+xml" title="Atom" href="/atom.xml"/>

        <!-- Scripts-->
        <script type="text/javascript" src="/js/head.min.js"></script>
        <script type="text/javascript">
            //Google analytics
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-15806710-5']);
            _gaq.push(['_trackPageview']);

            //Disqus
            var disqus_shortname = 'crodjer';
            
            head.js(
                "http://www.google-analytics.com/ga.js",
                "https://apis.google.com/js/plusone.js"
            );
            
            head.js("http://crodjer.disqus.com/count.js");
            head.js("http://crodjer.disqus.com/embed.js");
        </script>
  </head>
  <body>
      <div id="header">
    <span class="byline">what crodjer has to say...</span>
    <h1><a href="/">Rohan Jain</a></h1>
</div>

<div id="content">
    
<div class="post">
    <h2 class="post-title" id="configure-ssh-to-handle-proxies-and-tunnels-seamlessly"><a href="/coding/2011/08/27/configure-ssh-to-handle-proxies-and-tunnels-seamlessly/">Configure ssh to handle proxies and tunnels seamlessly</a></h2>
<div class="meta">
    <span class="date">
        <img alt="Posted on" src="/images/calendar.png"/> 27 Aug, 2011
    </span>
    <span class="share">
    </span>
    <span class="tags" >
        
        <img alt="Tags" src="/images/tag.png"/>
        
        <a href="/tags/tunneling">tunneling</a>
        
        <a href="/tags/ssh">ssh</a>
        
        <a href="/tags/config">config</a>
        
        
    </span>

    <a class="comments" href="/coding/2011/08/27/configure-ssh-to-handle-proxies-and-tunnels-seamlessly/#disqus_thread" data-disqus-identifier="configure-ssh-to-handle-proxies-and-tunnels-seamlessly">Comments</a>
</div>


    <div class='post-text'>
        
        <p>Recently I opened up on the port <em>443</em> over my EC2 instance, so that I can
access it through any firewalled proxy too. Apart from getting SSH running
to a machine from outside world, I did some cool configurations to have ssh
deal with with various remote hosts automatically. It uses <em>the right</em>
proxy settings according the host being accessed. Here is how it goes.</p>

<p>All the stuff which runs over ssh (like <em>scp</em>, <em>git</em> etc.) also work the way
they are supposed to, following the ssh configuration.</p>

<p>To get this to work you need to have <em>corkscrew</em> and <em>netcat</em> (the swiss army
knife) already installed.</p>

<p><code>File ~/ssh/config:</code></p>

<div class="highlight"><pre><code class="apache"><span class="c"># Let me access local remotes directly.</span>
<span class="nb">Host</span> <span class="m">127.0.0.1</span>, <span class="m">10</span>.*
    <span class="nb">ProxyCommand</span> <span class="k">none</span>

<span class="c"># Let me ssh onto my ec2 instance, which has full network access, through a</span>
<span class="c"># http proxy.</span>
<span class="nb">Host</span> ecc.rohanjain.in
    <span class="nb">ProxyCommand</span> corkscrew <span class="m">10.3.100.211</span> <span class="m">8080</span> %h %p
        <span class="nb">Port</span> <span class="m">443</span>
            <span class="nb">ServerAliveInterval</span> <span class="m">600</span>

<span class="c"># All the rest should connect through an ssh connection over the ec2 instance.</span>
<span class="nb">Host</span> *
    <span class="nb">ProxyCommand</span> ssh -q -a -x -p <span class="m">443</span> ecc.rohanjain.in nc %h %p
</code></pre>
</div>


        
    </div>
</div>



<div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_identifier = 'configure-ssh-to-handle-proxies-and-tunnels-seamlessly';
        var disqus_title = 'Configure ssh to handle proxies and tunnels seamlessly';
        var disqus_url = 'http://www.rohanjain.in/coding/2011/08/27/configure-ssh-to-handle-proxies-and-tunnels-seamlessly/';
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</div>


</div>

<div id="sidebar">
    <ul>
        <li><a href="/">Blog</a></li>
        <li><a href="/about">About Me</a></li>
        <li><a href="http://github.com/crodjer">Code</a></li>
        <li><a href="/archive">Archive</a></li>
    </ul>
</div>

<div id="footer">
    <p>
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/80x15.png" /></a>
        Using <a href="http://jekyllrb.com/">Jekyll</a>,
        <a href="http://pygments.org/">Pygments</a>
        | <a href="/sitemap.xml">Sitemap</a>, <a href="http://feeds.feedburner.com/crodjerBlog">Feed</a>
    </p>
</div>

 </body>
</html>
