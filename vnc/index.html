<!DOCTYPE html>
<html lang="en-US">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="author" content="Rohan Jain">
<meta name="description" content="About a year ago, I switched my parents computer (lets call it P) from the pre-installed OS (Windows) to Ubuntu. The primary reason for this switch was it hard for me to debug and fix issues. Things have been smooth after the switch with no issues which I found hard to fix remotely. What specially has worked is my ability to log in to the computer when its on through my VPS and service it.">

<meta property="og:title" content="VNC over reverse SSH" />
<meta property="og:description" content="About a year ago, I switched my parents computer (lets call it P) from the pre-installed OS (Windows) to Ubuntu. The primary reason for this switch was it hard for me to debug and fix issues. Things have been smooth after the switch with no issues which I found hard to fix remotely. What specially has worked is my ability to log in to the computer when its on through my VPS and service it." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/vnc/" />



<meta property="article:published_time" content="2015-05-10T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2015-05-10T00:00:00&#43;00:00"/>












<title>


     VNC over reverse SSH 

</title>
<link rel="canonical" href="/vnc/">










<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500">



    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/pygments.css">
    <link rel="stylesheet" href="/css/main.css">
    
        <link rel="stylesheet" href="/css/override.css">
    




<link rel="shortcut icon"

    href="/static/img/favicon.ico"

>








</head>


<body lang="en">

<section class="header">
    <div class="container">
        <div class="content">
            
            <a href="/"><img class="avatar" src="https://gravatar.com/avatar/564e7aa79de47cdf3a094da1d4ac13cd?s=50" rcset="https://gravatar.com/avatar/564e7aa79de47cdf3a094da1d4ac13cd?s=100 2x, https://gravatar.com/avatar/564e7aa79de47cdf3a094da1d4ac13cd?s=150 3x, https://gravatar.com/avatar/564e7aa79de47cdf3a094da1d4ac13cd?s=200 4x"></a>
            
            <a href="/"><div class="name">Rohan Jain</div></a>
            
            <nav>
                <ul>
                    
                        <li class="nav-about"><a href="/about/"><span>About</span></a></li>
                    
                </ul>
            </nav>
        </div>
    </div>
</section>

<section class="icons">
    <div class="container">
        <div class="content">

        
            <a href="//github.com/crodjer" target="_blank" rel="noopener"><img class="icon" src="/img/github.svg" alt="github" /></a>
        

        
            <a href="//twitter.com/__crodjer__" target="_blank" rel="noopener"><img class="icon" src="/img/twitter.svg" alt="twitter" /></a>
        

        

        

        
            <a href="//linkedin.com/in/crodjer" target="_blank" rel="noopener"><img class="icon" src="/img/linkedin.svg" alt="linkedin" /></a>
        

        

        
            
        

        

        

        
            <a href="/index.xml"><img class="icon" src="/img/rss.svg" alt="rss" /></a>
        
        
        </div>
    </div>
</section>


<section class="main post non-narrow zero-top-spacing">
    <div class="container">
        <div class="content">
            <div class="front-matter">
                <div class="title-container">
                    <div class="page-heading">

    VNC over reverse SSH

</div>

                    <div class="initials"><a href="/"></a></div>
                </div>
                <div class="meta">
                    
                    <div class="date" title='Sun May 10 2015 00:00:00 UTC'>May 10, 2015</div>
                    
                    
		    <div class="reading-time"><div class="middot"></div>2 minutes read</div>
                    
                </div>
            </div>
            <div class="markdown">
                

<p>About a year ago, I switched my parents computer (lets call it <code>P</code>) from the
pre-installed OS (Windows) to Ubuntu. The primary reason for this switch was it
hard for me to debug and fix issues. Things have been smooth after the switch
with no issues which I found hard to fix remotely. What specially has worked is
my ability to log in to the computer when its on through my VPS and service it.</p>

<h2 id="reverse-ssh">Reverse SSH</h2>

<p>Whenever <code>P</code> starts, it makes a reverse SSH connection to my VPS. I use
<a href="https://www.archlinux.org/packages/community/x86_64/autossh/">autossh</a> to monitor and make sure that it is eventually always
connected.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ autossh -M <span class="m">10001</span> -f -NXYR <span class="m">10000</span>:localhost:22 vps
</code></pre></div>

<p>Here <code>vps</code> is a SSH alias for my personal VPS.</p>

<p>I can tunnel through the VPS and login to <code>P</code> via VPS using the following SSH
configuration:</p>

<pre><code>Host home
     Hostname localhost
     User username
     Port 10000
     ProxyCommand ssh -e none -W %h:%p vps
</code></pre>

<p>To log in to <code>P</code> transparently, I can simply do:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ ssh home
</code></pre></div>

<p>I use this to resolve most of the issues. Of course it does have the requirement
that the system be booted up and connected to a network.</p>

<h2 id="vnc">VNC</h2>

<p>There also can be issues which have to do with the GUI (say browser maintenance)
and cannot be done easily over a text SSH session. For those cases, VNC is to
rescue. I create a VNC server on <code>P</code> using <a href="https://wiki.archlinux.org/index.php/X11vnc">x11vnc</a> and tunnel the VNC
port to my local through SSH. Now, I can access <code>P</code>&rsquo;s graphical session remotely
via a vnc client (mine is <a href="https://www.archlinux.org/packages/community/x86_64/tigervnc/">tigervnc</a>).</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ ssh home -L <span class="m">5900</span>:localhost:5900 <span class="s2">&quot;x11vnc -rfbauth ~/.vnc/passwd -display :0 -noxdamage&quot;</span>
$ vncviewer localhost::5900 -QualityLevel <span class="m">3</span> -CompressLevel <span class="m">6</span>
</code></pre></div>

<p>This method is much better compared to the more common solutions such has
Google&rsquo;s VNC chrome extension or other proprietary services. But they are slow
and untrustable 3rd parties. With this way of setting up VNC, everything is
protected under SSH connections.</p>

                <br>
		<p class="back-to-posts"><a href="/blog/">Back to posts</a></p>
            </div>
            <br>
            <div class="disqus">
                
            </div>
            
        </div>
    </div>
</section>



<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-15806710-5', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>







</body>
</html>

