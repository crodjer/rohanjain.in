<!doctype html><html lang=en-US><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=author content="Rohan Jain"><meta name=description content="VNC over reverse SSH | Rohan's Personal Web Blog."><meta property="og:title" content="VNC over reverse SSH"><meta property="og:type" content="article"><meta property="article:published_time" content="2015-05-10T00:00:00+00:00"><meta property="article:modified_time" content="2015-05-10T00:00:00+00:00"><title>VNC over reverse SSH</title><link rel=canonical href=/vnc/><link rel=stylesheet href=/css/main.min.97ffe0e39b9819392033e2635f05ec47c705d94936b7483bb66889dbf15d7a90.css><link rel="shortcut icon" href=/img/favicon.ico></head><body lang=en><header><a href=/>The Perpetual Amature</a><nav><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li></ul></nav></header><main><article><header><h1>VNC over reverse SSH</h1><small><time datetime=2015-05-10 title='Sun May 10 2015 00:00:00 UTC'>May 10, 2015</time>
| 2 minutes read</small></header><blockquote><p>Note: My <a href=/jumper>recent article</a>, talking about WireGuard is a
better and more ergonomic approach to achive this, compared to using
reverse SSH.</p></blockquote><p>About a year ago, I switched my parents computer (lets call it <code>P</code>) from the
pre-installed OS (Windows) to Ubuntu. The primary reason for this switch was it
hard for me to debug and fix issues. Things have been smooth after the switch
with no issues which I found hard to fix remotely. What specially has worked is
my ability to log in to the computer when its on through my VPS and service it.</p><h2 id=reverse-ssh><a class=heading-anchor href=#reverse-ssh aria-label="Permalink to Reverse SSH">ยง</a>
Reverse SSH</h2><p>Whenever <code>P</code> starts, it makes a reverse SSH connection to my VPS. I use
<a href=https://www.archlinux.org/packages/community/x86_64/autossh/>autossh</a> to monitor and make sure that it is eventually always
connected.</p><pre><code class=language-bash>$ autossh -M 10001 -f -NXYR 10000:localhost:22 vps
</code></pre><p>Here <code>vps</code> is a SSH alias for my personal VPS.</p><p>I can tunnel through the VPS and login to <code>P</code> via VPS using the following SSH
configuration:</p><pre><code>Host home
     Hostname localhost
     User username
     Port 10000
     ProxyCommand ssh -e none -W %h:%p vps
</code></pre><p>To log in to <code>P</code> transparently, I can simply do:</p><pre><code class=language-bash>$ ssh home
</code></pre><p>I use this to resolve most of the issues. Of course it does have the requirement
that the system be booted up and connected to a network.</p><h2 id=vnc><a class=heading-anchor href=#vnc aria-label="Permalink to VNC">ยง</a>
VNC</h2><p>There also can be issues which have to do with the GUI (say browser maintenance)
and cannot be done easily over a text SSH session. For those cases, VNC is to
rescue. I create a VNC server on <code>P</code> using <a href=https://wiki.archlinux.org/index.php/X11vnc>x11vnc</a> and tunnel the VNC
port to my local through SSH. Now, I can access <code>P</code>&rsquo;s graphical session remotely
via a vnc client (mine is <a href=https://www.archlinux.org/packages/community/x86_64/tigervnc/>tigervnc</a>).</p><pre><code class=language-bash>$ ssh home -L 5900:localhost:5900 &quot;x11vnc -rfbauth ~/.vnc/passwd -display :0 -noxdamage&quot;
$ vncviewer localhost::5900 -QualityLevel 3 -CompressLevel 6
</code></pre><p>This method is much better compared to the more common solutions such has
Google&rsquo;s VNC chrome extension or other proprietary services. But they are slow
and untrustable 3rd parties. With this way of setting up VNC, everything is
protected under SSH connections.</p></article></main><footer><a href=/blog>All Posts</a>
<a href=//github.com/crodjer target=_blank rel=noopener>Github</a>
<a href=//linkedin.com/in/crodjer target=_blank rel=noopener>Linkedin</a>
<a href=//twitter.com/__crodjer__ target=_blank rel=noopener>Twitter</a></footer><script data-goatcounter=https://t.rohanjain.in/count async src=/js/count.min.4e3257a9873dba863f309fe89287c9f6e962d7be1758704f13b2608e58008e5f.js></script><noscript><img src="https://t.rohanjain.in/count?p=%2fvnc%2f&t=VNC%20over%20reverse%20SSH"></noscript></body></html>